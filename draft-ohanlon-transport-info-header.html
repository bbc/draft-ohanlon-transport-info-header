<!DOCTYPE html>
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>The Transport-Info HTTP Header</title><script>
function anchorRewrite() {
  map = { };
  if (window.location.hash.length >= 1) {
    var fragid = window.location.hash.substr(1);
    if (fragid) {
      if (! document.getElementById(fragid)) {
        var prefix = "rfc.";
        var mapped = map[fragid];
        if (mapped) {
          window.location.hash = mapped;
        } else if (fragid.indexOf("section-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(8);
        } else if (fragid.indexOf("appendix-") == 0) {
          window.location.hash = prefix + "section." + fragid.substring(9);
        } else if (fragid.indexOf("s-") == 0) {
          var postfix = fragid.substring(2);
          if (postfix.startsWith("abstract")) {
            window.location.hash = prefix + postfix;
          } else if (postfix.startsWith("note-")) {
            window.location.hash = prefix + "note." + postfix.substring(5);
          } else {
            window.location.hash = prefix + "section." + postfix;
          }
        } else if (fragid.indexOf("p-") == 0) {
          var r = fragid.substring(2);
          var p = r.indexOf("-");
          if (p >= 0) {
            window.location.hash = prefix + "section." + r.substring(0, p) + ".p." + r.substring(p + 1);
          }
        }
      }
    }  
  }
}
window.addEventListener('hashchange', anchorRewrite);
window.addEventListener('DOMContentLoaded', anchorRewrite);
</script><!--Specified as xml2rfc-ext-css-contents--><style>
body {
  font: 16px "Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  color: #333;
  font-size-adjust: 0.5;
  line-height: 24px;
  margin: 75px auto;
  max-width: 624px;
  padding: 0 5px;
}

.title, .filename, h1, h2, h3, h4, h5 {
  font: 16px "Roboto Condensed","Helvetica Neue","Open Sans",Helvetica,Calibri,sans-serif;
  font-size-adjust: 0.5;
  font-weight: bold;
  color: #333;
  line-height: 100%;
  margin: 1.2em 0 0.3em;
}
.title, #rfc\.title h1 { font-size: 32px; }
h1, section h1, h2, section h2, section h3, nav h2 { font-size: 20px; }
h3, section h4, h4, section h5 { font-size: 16px; }
h1 a[href], h2 a[href], h3 a[href], h4 a[href] {
  color: #333;
}

table {
  margin-left: 0em;
  border-collapse: collapse;
}
th {
  text-align: left;
  border-bottom: 2px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
  vertical-align: top;
}
tr:nth-child(2n+1) > td,
tr:nth-child(2n+1) > th {
  background-color: #f9f9f9;
}
td.reference {
  max-width: 200px;
  border-top: none;
  padding-right: 1em;
}
.right {
  text-align: right;
}


table.header, table#rfc\.headerblock {
  width: 100%;
}
table.header td, table#rfc\.headerblock td {
  border: none;
  background-color: transparent;
  color: black;
  padding: 0;
}
.filename {
  display: block;
  color: rgb(119, 119, 119);
  font-size: 20px;
  font-weight: normal;
  line-height: 100%;
  margin: 10px 0 32px;
}
#rfc\.abstract+p, #rfc\.abstract+p code, #rfc\.abstract+p samp, #rfc\.abstract+p tt {
  font-size: 20px;
  line-height: 28px;
}

samp, tt, code, pre, span.tt {
  font-size: 13.5px;
  font-family: Consolas, monospace;
  font-size-adjust: none;
}
pre {
  background-color: #eee;
  border: 1px solid #ddd;
  overflow-x: auto;
  padding: 5px;
  margin: 5px;
}
.figure, caption {
  font-style: italic;
  margin: 0 1.5em;
  text-align: left;
}

address {
  margin: 16px 2px;
  line-height: 20px;
}
.vcard {
  font-style: normal;
}
.vcardline {
  display: block;
}
.vcardline .fn, address b {
  font-weight: normal;
}
.vcardline .hidden {
  display: none;
}

dl {
  margin-left: 1em;
}
dl.dl-horizontal: {
  margin-left: 0;
}
dl > dt {
  float: left;
  margin-right: 1em;
}
dl.nohang > dt {
  float: none;
}
dl > dd {
  margin-bottom: .5em;
}
dl.compact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}

hr {
  border: 0;
  border-top: 1px solid #eee;
}
hr.noprint {
  display: none;
}

a {
  text-decoration: none;
}
a[href] {
  color: #2a6496;
}
a[href]:hover {
  background-color: #eee;
}

p, ol, ul, li {
  padding: 0;
}
p {
  margin: 0.5em 0;
}
ol, ul {
  margin: 0.2em 0 0.2em 2em;
}
li {
  margin: 0.2em 0;
}
address {
  font-style: normal;
}

ul.toc ul {
  margin: 0 0 0 2em;
}
ul.toc li {
  list-style: none;
  margin: 0;
}

@media screen and (min-width: 924px) {
  body {
    padding-right: 350px;
  }
  body>ul.toc, body>#rfc\.toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 500px);
    width: 300px;
    z-index: 1;
    overflow: auto;
    overscroll-behavior: contain;
  }
  body>#rfc\.toc {
    top: 55px;
  }
  body>ul.toc {
    top: 100px;
  }

  ul.toc {
    margin: 0 0 0 4px;
    font-size: 12px;
    line-height: 20px;
  }
  ul.toc ul {
    margin-left: 1.2em;
  }
}</style><link rel="Contents" href="#rfc.toc"><link rel="Author" href="#rfc.authors"><link rel="License" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 The Transport-Info HTTP Header" href="#rfc.section.2"><link rel="Chapter" title="3 Server based behaviour" href="#rfc.section.3"><link rel="Chapter" title="4 Client based behaviour" href="#rfc.section.4"><link rel="Chapter" title="5 IANA Considerations" href="#rfc.section.5"><link rel="Chapter" title="6 Security Considerations" href="#rfc.section.6"><link rel="Chapter" title="7 References" href="#rfc.section.7"><link rel="Appendix" title="A Acknowledgements" href="#rfc.section.A"><link rel="Appendix" title="B Changes" href="#rfc.section.B"><meta name="viewport" content="initial-scale=1"><meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.1256, 2020/02/20 09:08:59, XSLT vendor: libxslt http://xmlsoft.org/XSLT/, via: https://github.com/cabo/kramdown-rfc2629 version 1.2.13"><meta name="keywords" content="Internet-Draft"><link rel="schema.dcterms" href="http://purl.org/dc/terms/"><meta name="dcterms.creator" content="O'Hanlon, P."><meta name="dcterms.creator" content="Gruessing, J."><meta name="dcterms.issued" content="2020-03-03"><meta name="dcterms.abstract" content="The Transport-Info header provides a mechanism to transmit network transport related information such as current delivery rate and round-trip time, from a server or a client. This information has a wide range of uses such as client monitoring and diagnostics, or allowing a client to adapt to current network conditions."><meta name="description" content="The Transport-Info header provides a mechanism to transmit network transport related information such as current delivery rate and round-trip time, from a server or a client. This information has a wide range of uses such as client monitoring and diagnostics, or allowing a client to adapt to current network conditions."></head><body><header><table class="header" id="rfc.headerblock"><tbody><tr><td class="left">HTTP</td><td class="right">P. O'Hanlon</td></tr><tr><td class="left">Internet-Draft</td><td class="right">J. Gruessing</td></tr><tr><td class="left">Intended status: Standards Track</td><td class="right">British Broadcasting Corporation</td></tr><tr><td class="left">Expires: September 4, 2020</td><td class="right">March 3, 2020</td></tr></tbody></table><div id="rfc.title"><h1>The Transport-Info HTTP Header</h1><div class="filename"><a href="https://datatracker.ietf.org/doc/draft-ohanlon-transport-info-header" class="smpl">draft-ohanlon-transport-info-header-latest</a></div></div></header><section><h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2><div id="rfc.abstract.p.1"><p>The Transport-Info header provides a mechanism to transmit network transport related information such as current delivery rate and round-trip time, from a server or a client. This information has a wide range of uses such as client monitoring and diagnostics, or allowing a client to adapt to current network conditions.</p></div></section><section class="note"><h2 id="rfc.note.1"><a href="#rfc.note.1">Note to Readers</a></h2><div id="rfc.note.1.p.1"><p><em>RFC Editor: please remove this section before publication</em></p></div><div id="rfc.note.1.p.2"><p>Source code and issues for this draft can be found at <a href="https://github.com/bbc/draft-ohanlon-transport-info-header">https://github.com/bbc/draft-ohanlon-transport-info-header</a>.</p></div></section><section id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><div id="rfc.boilerplate.1.p.1"><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p></div><div id="rfc.boilerplate.1.p.2"><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p></div><div id="rfc.boilerplate.1.p.3"><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress”.</p></div><div id="rfc.boilerplate.1.p.4"><p>This Internet-Draft will expire on September 4, 2020.</p></div></section><section id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><div id="rfc.boilerplate.2.p.1"><p>Copyright (c) 2020 IETF Trust and the persons identified as the document authors. All rights reserved.</p></div><div id="rfc.boilerplate.2.p.2"><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p></div></section><hr class="noprint"><nav id="rfc.toc"><h2 class="np"><a href="#rfc.toc">Table of Contents</a></h2><ul class="toc"><li><a href="#rfc.section.1">1.</a>   <a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1.</a>   <a href="#motivation">Motivation</a></li><li><a href="#rfc.section.1.2">1.2.</a>   <a href="#use-cases">Use Cases</a></li><li><a href="#rfc.section.1.3">1.3.</a>   <a href="#notational-conventions">Notational Conventions</a></li></ul></li><li><a href="#rfc.section.2">2.</a>   <a href="#the-transport-info-http-header">The Transport-Info HTTP Header</a><ul><li><a href="#rfc.section.2.1">2.1.</a>   <a href="#utilisation-of-transport-info-header-metrics">Utilisation of Transport-Info header metrics</a></li></ul></li><li><a href="#rfc.section.3">3.</a>   <a href="#server-based-behaviour">Server based behaviour</a></li><li><a href="#rfc.section.4">4.</a>   <a href="#client-based-behaviour">Client based behaviour</a><ul><li><a href="#rfc.section.4.1">4.1.</a>   <a href="#client-side-proxy-considerations">Client side proxy considerations</a></li></ul></li><li><a href="#rfc.section.5">5.</a>   <a href="#iana-considerations">IANA Considerations</a></li><li><a href="#rfc.section.6">6.</a>   <a href="#security-considerations">Security Considerations</a><ul><li><a href="#rfc.section.6.1">6.1.</a>   <a href="#sec-privacy">Privacy Considerations</a></li><li><a href="#rfc.section.6.2">6.2.</a>   <a href="#information-control">Information control</a></li></ul></li><li><a href="#rfc.section.7">7.</a>   <a href="#rfc.references">References</a><ul><li><a href="#rfc.section.7.1">7.1.</a>   <a href="#rfc.references.1">Normative References</a></li><li><a href="#rfc.section.7.2">7.2.</a>   <a href="#rfc.references.2">Informative References</a></li></ul></li><li><a href="#rfc.section.A">Appendix A.</a>   <a href="#acknowledgements">Acknowledgements</a></li><li><a href="#rfc.section.B">Appendix B.</a>   <a href="#changes">Changes</a><ul><li><a href="#rfc.section.B.1">B.1.</a>   <a href="#since-00">Since -00</a></li></ul></li><li><a href="#rfc.authors">Authors' Addresses</a></li></ul></nav><section id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a> <a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>The Transport-Info header provides for relaying of transport protocol related information from either a server or client entity with the aim of informing the sender’s view on the transport state. The state of a connection is dependent upon information based upon packet exchanges during the transport processes. Firstly, there is information that is common to both client and server, such as the calculated round-trip time (RTT), although it may be measured using different packets at each end. Secondly, there is state information that exists only at each endpoint, such as the size of the congestion, and receive windows. Thus certain transport state information is only available at the server which can be useful to the client, for example, to calculate the current transport rate. This information may then be used to better inform a client of the state of the network path and make appropriate adaptations.</p></div><div id="rfc.section.1.p.2"><p>The information can also be utilised by a client to provide for application level client oriented metric logging to back-end systems for monitoring and analysis purposes. Such data could be utilised in a manner not unlike that proposed in <a href="#RFC4898"><cite title="TCP Extended Statistics MIB">[RFC4898]</cite></a>.</p></div><div id="rfc.section.1.p.3"><p>This approach is directly applicable to TCP but also can be utilised with other related transport protocols, such as QUIC <a href="#I-D.ietf-quic-transport"><cite title="QUIC: A UDP-Based Multiplexed and Secure Transport">[I-D.ietf-quic-transport]</cite></a>.</p></div><section id="motivation"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1.</a> <a href="#motivation">Motivation</a></h3><div id="rfc.section.1.1.p.1"><p>This work is motivated, in part, by the fact that even modern web browser-based web applications are not currently able to obtain such low level information about specific connections. Additionally, some information is only available at the server, such as the size of the server congestion window. As a result clients often resort to application level measurements, to infer such things as the current delivery rate. However, these are not always indicative of the performance of the transport layer, and may not be sufficiently precise due to a couple of issues; Firstly, browser based timing is limited by the granularity of the JavaScript timers, which were reduced in the light of timing based side-channel attacks, although due to new mitigations such timer limits are currently of the order 5us-1ms. These limits can be an issue for higher rate connections and/or those with smaller transactions. Secondly, with flows where the content-length is unknown, such as with chunked transfer encoding, it is currently difficult to correctly measure the bandwidth in the browser as the even the fetch/streams APIs do not provide for sufficient information.</p></div><div id="rfc.section.1.1.p.2"><p>There exist W3C specifications such as the Network Information API <a href="#network-info-api"><cite title="Network Information API">[network-info-api]</cite></a>, which provides estimates of metrics, including downlink rate and RTT, that are measured “across recently active connections”, but are platform and browser dependent, with limited cross-browser support. In practice the downlink measurement is is generally of low accuracy and of little use for informing an application of dynamic network conditions, and the RTT measurement is also of low accuracy. However, it is implemented in Chrome and the utilisation of the API is now seen in a large proportion of websites, mainly due to adoption of the API by widely used libraries.</p></div><div id="rfc.section.1.1.p.3"><p>This information is already being sent by servers and clients so this document specifies a standard way for entities to encode and transport such information.</p></div></section><section id="use-cases"><h3 id="rfc.section.1.2"><a href="#rfc.section.1.2">1.2.</a> <a href="#use-cases">Use Cases</a></h3><div id="rfc.section.1.2.p.1" class="avoidbreakafter"><p>The header can be used to provide sender specific transport information that can inform a range of functions:</p></div><div id="rfc.section.1.2.p.2"><ul><li>Assist or drive the media quality selection algorithms for streaming media.</li><li>Inform initial rate selection.</li><li>Provide better bandwidth information for shorter requests (e.g. gRPC, audio) which are harder to measure. <ul><li>Could be used to drive scheduling of different flows in systems such as Traefik. </li></ul></li><li>The RTT values are useful for informing the operation of latency sensitive applications. </li><li>The RTTVAR could be used to provide an estimate of ‘reliability’ of rtt and bandwidth estimates.</li><li>Inform client/browser media/data caching strategies.</li><li>Use by intermediate nodes for traffic analytics and control.</li></ul></div></section><section id="notational-conventions"><h3 id="rfc.section.1.3"><a href="#rfc.section.1.3">1.3.</a> <a href="#notational-conventions">Notational Conventions</a></h3><div id="rfc.section.1.3.p.1"><p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in BCP 14 <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a> <a href="#RFC8174"><cite title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">[RFC8174]</cite></a> when, and only when, they appear in all capitals, as shown here.</p></div><div id="rfc.section.1.3.p.2"><p>This document uses the Augmented Backus-Naur Form (ABNF) notation of <a href="#RFC5234"><cite title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</cite></a> with the list rule extension defined in <a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a>, Appendix B. It includes by reference the DIGIT rule from <a href="#RFC5234"><cite title="Augmented BNF for Syntax Specifications: ABNF">[RFC5234]</cite></a> and the OWS and field-name rules from <a href="#RFC7230"><cite title="Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing">[RFC7230]</cite></a>.</p></div></section></section><section id="the-transport-info-http-header"><h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#the-transport-info-http-header">The Transport-Info HTTP Header</a></h2><div id="rfc.section.2.p.1"><p>The Transport-Info header uses the proposed Structured Header draft <a href="#I-D.ietf-httpbis-header-structure"><cite title="Structured Headers for HTTP">[I-D.ietf-httpbis-header-structure]</cite></a></p></div><div id="rfc.figure.u.1"><div><pre class="inline">
        Transport-Info = sh-list
</pre></div></div><div id="rfc.section.2.p.2"><p>Each member of the parameterised list represents an entry that contains a set of metrics reported.</p></div><div id="rfc.section.2.p.3"><p>The list members identify either the server or client that inserted the value, and MUST have a type of either sh-string or sh-token. Depending on the deployment, this might be a product or service name (e.g., ExampleEdge or “Example CDN”), a hostname (“edge-1.example.com”), and IP address, or a generated string.</p></div><div id="rfc.section.2.p.4"><p>Each member of the list can also have a number of parameters that contain metrics. While all but one of these parameters are OPTIONAL, implementations are encouraged to only provide as much information as necessary.</p></div><div id="rfc.section.2.p.5"><ul><li>Exactly one parameter whose name is “ts”, and whose value is an sh-string indicating the measurement timestamp in <a href="#RFC3339"><cite title="Date and Time on the Internet: Timestamps">[RFC3339]</cite></a> format.</li><li>Optionally one parameter whose name is “alpn”, and whose value is an sh-string representing the ALPN protocol identifier <a href="#alpn-ids"><cite title="Application-Layer Protocol Negotiation (ALPN) Protocol ID">[alpn-ids]</cite></a>.</li><li>Optionally one parameter whose name is “cc_algo”, and whose value is sh-string, conveying the name of congestion control algorithm used for this connection.</li><li>Optionally one parameter whose name is “cwnd”, and whose value is a sh-integer, conveying the size of the congestion window <a href="#RFC5681"><cite title="TCP Congestion Control">[RFC5681]</cite></a> in packets.</li><li>Optionally one parameter whose name is “rcv_space”, and whose value is a sh-integer, conveying the size of the receiver’s window in bytes.</li><li>Optionally one parameter whose name is “dstport”, and whose value is a sh-integer, conveying the destination port of this connection for correlation of measurements between requests.</li><li>Optionally one parameter whose name is “mss”, and whose value is a sh-integer, conveying the size of the Maximum Segment Size in bytes.</li><li>Optionally one parameter whose name is “rtt”, and whose value is an sh-float, in milliseconds, indicating the estimate of the Round-Trip Time from its transport layer.</li><li>Optionally one parameter whose name is “rttvar”, and whose value is an sh-float, in milliseconds, indicating the estimate of the variation of the Round-Trip Time <a href="#RFC6298"><cite title="Computing TCP's Retransmission Timer">[RFC6298]</cite></a> from its transport layer.</li><li>Optionally one parameter whose name is “send_rate”, and whose value is a sh-float, in kilobits per second, conveying the calculation of the sending rate for this connection.</li></ul></div><div id="rfc.section.2.p.6" class="avoidbreakafter"><p>Here is an example of a header with a single set of metrics:</p></div><div id="rfc.figure.u.2"><div><pre class="text">
Transport-Info = ExampleEdge; ts="2019-08-30T14:56:08.069Z";
                  alpn="h2"; send_rate="5100"
</pre></div></div><div id="rfc.section.2.p.7"><p>Whilst it is understood that such metrics may only provide an instantaneous view on the transport state, the Transport-Info header is designed to allow for delivery of multiple timestamped entries in a single header.</p></div><div id="rfc.section.2.p.8" class="avoidbreakafter"><p>Here is an example of the header with multiple entries, utilising the structured header inner-list type:</p></div><div id="rfc.figure.u.3"><div><pre class="text">
Transport-Info = "edge-1.example.com"; ts="2019-08-30T14:56:08Z";
                  cwnd=24; rtt=50; mss=1452; rttvar=10; dstport=8065,
                 "edge-1.example.com"; ts="2019-08-30T14:57:08Z";
                  cwnd=23; rtt=55; mss=1452; rttvar=12; dstport=8065
</pre></div></div><div id="rfc.section.2.p.9"><p>If the end points support HTTP/2, and later, another technique to increase temporal coverage for an ongoing session is for the client to issue additional HEAD requests for the resource at the same origin. This works with HTTP/2, and later, as all requests to the same origin usually utilise one TCP or QUIC connection. Whilst the HTTP priorities can affect the allocation of capacity between streams the header will still provide an estimate of the maximum available capacity. Likewise, in some cases with HTTP/2, and later, there may be multiple flows traversing the same transport connection to different origins if connection reuse (Section 9.1.1 of <a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>) is utilised, which could have a similar effect on interpretation of the metrics to HTTP priorities, but may have privacy implications which are addressed in the privacy section <a href="#sec-privacy" title="Privacy Considerations">Section 6.1</a>.</p></div><section id="utilisation-of-transport-info-header-metrics"><h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> <a href="#utilisation-of-transport-info-header-metrics">Utilisation of Transport-Info header metrics</a></h3><div id="rfc.section.2.1.p.1"><p>The metrics may be used directly to inform entities that receive the header. The calculation of the send rate maybe performed by the sender of the header and included in the send_rate parameter, or the receiver may calculate it as described below. The decision may depend upon a variety of factors including the privacy consideration of transporting any required parameters.</p></div><div id="rfc.section.2.1.p.2" class="avoidbreakafter"><p>In the case of TCP, calculation of the transport transmission rate is possible using the cwnd and rtt, and knowledge of the mss. The equation being as follows:</p></div><div id="rfc.figure.u.4"><div><pre>
    send_rate = 8 * send_window / rtt

    Where send_window = min (cwnd * mss, rcv_space)
</pre></div></div><div id="rfc.section.2.1.p.3"><p>If the mss is not available then it is possible to perform the calculation using an estimate of the mss, or a common value such as 1460 for IPv4. It is understood there can be some variation for different network and tunnelled paths (e.g. 1452 for IPv4 PPPoE) as can been seen in recent studies <a href="#exploring-mtu"><cite title="Exploring usable Path MTU in the Internet">[exploring-mtu]</cite></a>, although the large proportion of mss values fall within a range 1220-1460. The send_window is preferably calculated using a minimum of the cwnd and rcv_space, but if the rcv_space is not available it may be approximated by just using the cwnd.</p></div><div id="rfc.section.2.1.p.4"><p>This equation maybe applied for other related window based transport protocols (e.g. QUIC <a href="#I-D.ietf-quic-transport"><cite title="QUIC: A UDP-Based Multiplexed and Secure Transport">[I-D.ietf-quic-transport]</cite></a>) with similar information, although it may need some modification.</p></div></section></section><section id="server-based-behaviour"><h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#server-based-behaviour">Server based behaviour</a></h2><div id="rfc.section.3.p.1"><p>With most web server deployments an origin server sits behind some form of CDN, with varying levels of fan-out to a point where an edge server is connected on the last hop to clients. The Transport-Info header SHOULD only be inserted into an HTTP stream by the last hop edge server that is connected to clients so that it conveys information pertinent to the client’s direct transport path. The Transport-Info header MUST not be cached.</p></div><div id="rfc.section.3.p.2"><p>With respect to use in CORS <a href="#cors"><cite title="Cross-Origin Resource Sharing">[cors]</cite></a> enabled environments access to the header will be subject to restrictions in cross domain requests, which may be controlled through the inclusion of the Transport-Info header in the Access-Control-Request-Headers header.</p></div><div id="rfc.section.3.p.3"><p>The use of the header is expected to comply with data minimisation approaches where servers only send the necessary information on relevant flows.</p></div><div id="rfc.section.3.p.4"><p><em>RFC Editor: please remove this section before publication</em></p></div><div id="rfc.section.3.p.5"><p>The provision of the Transport-Info header is possible using a number of existing server systems that already provide support for such metrics, which currently utilise operating system support for the <span class="tt">tcp_info</span> data structure which is available on Linux and BSD based systems.</p></div><div id="rfc.section.3.p.6"><p>In terms of current implementations there is in-built support in Nginx/Openresty using its variables <span class="tt">var.tcpinfo_rtt</span> etc. Apache Traffic Server provides support using the TCPInfo plugin. Varnish provides access to <span class="tt">tcp_info</span> using their <span class="tt">vmod_tcp</span> module. Node.js has libraries such as <span class="tt">nodejs_tcpinfo</span> which provide support. Whilst most of the implementations do not provide access to the TCP MSS it is available via the underlying kernel <span class="tt">tcp_info</span> data structure so it would be fairly straightforward to provide access to such information.</p></div></section><section id="client-based-behaviour"><h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#client-based-behaviour">Client based behaviour</a></h2><div id="rfc.section.4.p.1"><p>The use of the header by a client is envisaged as a less common use-case since such information is generally less readily available on clients, and its general use might have privacy implications, although servers will be aware of most transport state already. We propose that use of the header could be controlled through the use of the Allow-CH header <a href="#I-D.ietf-httpbis-client-hints"><cite title="HTTP Client Hints">[I-D.ietf-httpbis-client-hints]</cite></a>. The header can enable the server to make better informed decisions based upon client based transport information. In the case of non-browser clients which have access to transport information directly through operating system interfaces, this information can be relayed using the header. Whilst with browser based clients such information could be obtained through the use of the JavaScript Network Information API.</p></div><section id="client-side-proxy-considerations"><h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#client-side-proxy-considerations">Client side proxy considerations</a></h3><div id="rfc.section.4.1.p.1"><p>In the case where a client is configured to utilise a proxy directly, or through the use of the HTTP CONNECT pseudo-method, this proxy should be configured according to local policy as to whether it passes through, modifies, or drops the Transport-Info header. This decision can depend on a number of factors, including whether the flows are encrypted, the utility of the header given local network configuration, and also whether the header might reveal unwanted information to end clients, since the Transport-Info header would relate to the connection between the edge CDN node and the proxy.</p></div></section></section><section id="iana-considerations"><h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#iana-considerations">IANA Considerations</a></h2><div id="rfc.section.5.p.1" class="avoidbreakafter"><p>This specification registers the following entry in the Permanent Message Header Field Names registry established by <a href="#RFC3864"><cite title="Registration Procedures for Message Header Fields">[RFC3864]</cite></a>:</p></div><div id="rfc.section.5.p.2" class="avoidbreakafter"><ul><li>Header field name: Transport-Info</li><li>Applicable protocol: http</li><li>Status: standard</li><li>Author/Change Controller: IETF</li><li>Specification document(s): [this document]</li><li>Related information:</li></ul></div></section><section id="security-considerations"><h2 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#security-considerations">Security Considerations</a></h2><section id="sec-privacy"><h3 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1.</a> <a href="#sec-privacy">Privacy Considerations</a></h3><div id="rfc.section.6.1.p.1"><p>The Transport-Info header provides information about a senders view of its network transport metrics, such as bandwidth and latency, to its receiver. This information may potentially be abused for such purposes as fingerprinting a user through their particular network metrics or a time series thereof. In some situations it might also be possible to infer location of users. This may also apply in the case where multiple users, or user identities, share a connection through the use of connection reuse mechanisms or otherwise.</p></div><div id="rfc.section.6.1.p.2"><p>However, these issues are not new and such information is already being shared by some servers and clients to arbitrary levels of accuracy. Furthermore, there are a number of other ways an attacker can obtain such information. In the client side, in a browser, there exist a number JavaScript based techniques to measure the bandwidth and latency through existing network APIs such as the Network Information, the Resource Timing, and WebRTC. On the server side, or a non-browser client, there is no limit to the techniques that may be applied to obtain information about network flows.</p></div></section><section id="information-control"><h3 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2.</a> <a href="#information-control">Information control</a></h3><div id="rfc.section.6.2.p.1" class="avoidbreakafter"><p>Whilst such information may be available through other mechanisms we recommend that implementers minimise any potential privacy issues through the application of the following approaches:</p></div><div id="rfc.section.6.2.p.2"><ul><li>The principle of data minimisation should be applied to any use of the header such that only information required for the purposes of the application be shared.</li><li>Any metrics deemed sensitive should apply an appropriate level of quantisation and noise to the values to a level that provides privacy whilst allowing for actual utility of the values.</li><li>Consideration of limits to the temporal update frequency of the metric values.</li><li>Any metrics that may be considered private should not be sent in the header, or should be appropriately protected.</li><li>Metrics should be sent over an encrypted connection.</li></ul></div><div id="rfc.section.6.2.p.3"><p>If the header is delivered over a transport protocol whose content can be modified without detection then parties should be aware that the header could be maliciously modified to alter the metrics values which could result in the client making incorrect adaptations.</p></div></section></section><section id="rfc.references"><h2 id="rfc.section.7"><a href="#rfc.section.7">7.</a> References</h2><section><div id="rfc.references.1"><h3 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a> Normative References</h3><dl class="reference"><dt id="I-D.ietf-httpbis-client-hints">[I-D.ietf-httpbis-client-hints]</dt><dd>Grigorik, I. and Y. Weiss, “<a href="https://tools.ietf.org/html/draft-ietf-httpbis-client-hints-10">HTTP Client Hints</a>”, Internet-Draft draft-ietf-httpbis-client-hints-10 (<a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-client-hints">work in progress</a>), February 2020.</dd><dt id="I-D.ietf-httpbis-header-structure">[I-D.ietf-httpbis-header-structure]</dt><dd>Nottingham, M. and P. Kamp, “<a href="https://tools.ietf.org/html/draft-ietf-httpbis-header-structure-15">Structured Headers for HTTP</a>”, Internet-Draft draft-ietf-httpbis-header-structure-15 (<a href="https://datatracker.ietf.org/doc/draft-ietf-httpbis-header-structure">work in progress</a>), January 2020.</dd><dt id="RFC2119">[RFC2119]</dt><dd>Bradner, S., “<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP 14, RFC 2119, <a href="http://dx.doi.org/10.17487/RFC2119">DOI 10.17487/RFC2119</a>, March 1997, &lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd><dt id="RFC3339">[RFC3339]</dt><dd>Klyne, G. and C. Newman, “<a href="https://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>”, RFC 3339, <a href="http://dx.doi.org/10.17487/RFC3339">DOI 10.17487/RFC3339</a>, July 2002, &lt;<a href="https://www.rfc-editor.org/info/rfc3339">https://www.rfc-editor.org/info/rfc3339</a>&gt;.</dd><dt id="RFC3864">[RFC3864]</dt><dd>Klyne, G., Nottingham, M., and J. Mogul, “<a href="https://tools.ietf.org/html/rfc3864">Registration Procedures for Message Header Fields</a>”, BCP 90, RFC 3864, <a href="http://dx.doi.org/10.17487/RFC3864">DOI 10.17487/RFC3864</a>, September 2004, &lt;<a href="https://www.rfc-editor.org/info/rfc3864">https://www.rfc-editor.org/info/rfc3864</a>&gt;.</dd><dt id="RFC5681">[RFC5681]</dt><dd>Allman, M., Paxson, V., and E. Blanton, “<a href="https://tools.ietf.org/html/rfc5681">TCP Congestion Control</a>”, RFC 5681, <a href="http://dx.doi.org/10.17487/RFC5681">DOI 10.17487/RFC5681</a>, September 2009, &lt;<a href="https://www.rfc-editor.org/info/rfc5681">https://www.rfc-editor.org/info/rfc5681</a>&gt;.</dd><dt id="RFC6298">[RFC6298]</dt><dd>Paxson, V., Allman, M., Chu, J., and M. Sargent, “<a href="https://tools.ietf.org/html/rfc6298">Computing TCP's Retransmission Timer</a>”, RFC 6298, <a href="http://dx.doi.org/10.17487/RFC6298">DOI 10.17487/RFC6298</a>, June 2011, &lt;<a href="https://www.rfc-editor.org/info/rfc6298">https://www.rfc-editor.org/info/rfc6298</a>&gt;.</dd><dt id="RFC8174">[RFC8174]</dt><dd>Leiba, B., “<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>”, BCP 14, RFC 8174, <a href="http://dx.doi.org/10.17487/RFC8174">DOI 10.17487/RFC8174</a>, May 2017, &lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;.</dd></dl></div></section><section><div id="rfc.references.2"><h3 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a> Informative References</h3><dl class="reference"><dt id="I-D.ietf-quic-transport">[I-D.ietf-quic-transport]</dt><dd>Iyengar, J. and M. Thomson, “<a href="https://tools.ietf.org/html/draft-ietf-quic-transport-27">QUIC: A UDP-Based Multiplexed and Secure Transport</a>”, Internet-Draft draft-ietf-quic-transport-27 (<a href="https://datatracker.ietf.org/doc/draft-ietf-quic-transport">work in progress</a>), February 2020.</dd><dt id="RFC4898">[RFC4898]</dt><dd>Mathis, M., Heffner, J., and R. Raghunarayan, “<a href="https://tools.ietf.org/html/rfc4898">TCP Extended Statistics MIB</a>”, RFC 4898, <a href="http://dx.doi.org/10.17487/RFC4898">DOI 10.17487/RFC4898</a>, May 2007, &lt;<a href="https://www.rfc-editor.org/info/rfc4898">https://www.rfc-editor.org/info/rfc4898</a>&gt;.</dd><dt id="RFC5234">[RFC5234]</dt><dd>Crocker, D., Ed. and P. Overell, “<a href="https://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>”, STD 68, RFC 5234, <a href="http://dx.doi.org/10.17487/RFC5234">DOI 10.17487/RFC5234</a>, January 2008, &lt;<a href="https://www.rfc-editor.org/info/rfc5234">https://www.rfc-editor.org/info/rfc5234</a>&gt;.</dd><dt id="RFC7230">[RFC7230]</dt><dd>Fielding, R., Ed. and J. Reschke, Ed., “<a href="https://tools.ietf.org/html/rfc7230">Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing</a>”, RFC 7230, <a href="http://dx.doi.org/10.17487/RFC7230">DOI 10.17487/RFC7230</a>, June 2014, &lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;.</dd><dt id="RFC7540">[RFC7540]</dt><dd>Belshe, M., Peon, R., and M. Thomson, Ed., “<a href="https://tools.ietf.org/html/rfc7540">Hypertext Transfer Protocol Version 2 (HTTP/2)</a>”, RFC 7540, <a href="http://dx.doi.org/10.17487/RFC7540">DOI 10.17487/RFC7540</a>, May 2015, &lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;.</dd><dt id="alpn-ids">[alpn-ids]</dt><dd>“<a href="http://www.iana.org/assignments/tls-extensiontype-values">Application-Layer Protocol Negotiation (ALPN) Protocol ID</a>”, IANA, n.d., &lt;<a href="http://www.iana.org/assignments/tls-extensiontype-values">http://www.iana.org/assignments/tls-extensiontype-values</a>&gt;.</dd><dt id="cors">[cors]</dt><dd>van Kesteren, A., “<a href="http://www.w3.org/TR/2014/REC-cors-20140116/">Cross-Origin Resource Sharing</a>”, W3C, January 2014, &lt;<a href="http://www.w3.org/TR/2014/REC-cors-20140116/">http://www.w3.org/TR/2014/REC-cors-20140116/</a>&gt;.</dd><dt id="exploring-mtu">[exploring-mtu]</dt><dd>Custura, A., Fairhurst, G., and I. Learmonth, “<a href="https://doi.org/10.23919/TMA.2018.8506538">Exploring usable Path MTU in the Internet</a>”, Network Traffic Measurement and Analysis Conference, April 2018, &lt;<a href="https://doi.org/10.23919/TMA.2018.8506538">https://doi.org/10.23919/TMA.2018.8506538</a>&gt;.</dd><dt id="network-info-api">[network-info-api]</dt><dd>Grigorik, I., “<a href="http://wicg.github.io/netinfo/">Network Information API</a>”, W3C, September 2019, &lt;<a href="http://wicg.github.io/netinfo/">http://wicg.github.io/netinfo/</a>&gt;.</dd></dl></div></section></section><section id="acknowledgements"><h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">Appendix A.</a> <a href="#acknowledgements">Acknowledgements</a></h2><div id="rfc.section.A.p.1"><p>The authors would like to thank Craig Taylor, Lucas Pardue, Patrick McManus, and the IETF HTTP Working Group for feedback on the development of this document.</p></div></section><section id="changes"><h2 id="rfc.section.B"><a href="#rfc.section.B">Appendix B.</a> <a href="#changes">Changes</a></h2><section id="since-00"><h3 id="rfc.section.B.1"><a href="#rfc.section.B.1">B.1.</a> <a href="#since-00">Since -00</a></h3><div id="rfc.section.B.1.p.1"><ul><li>Issue 1 (HTTP Tunnels): Added text regarding the use of HTTP CONNECT.</li><li>Issue 3 (Is sub-second resolution appropriate?): Changed from UNIC Epoch to RFC3339 time format.</li><li>Issue 4 (Could this be used for both request and response?): Updated text to describe both server and client use, and their implications.</li><li>Issue 5 (Privacy Implications): Added new Privacy Considerations section and updated security section</li><li>Issue 9 (CORS considerations): Added text to address CORS usage.</li><li>Issue 10 (Provide additional use-cases): Updated motivation and added use-cases section.</li></ul></div></section></section><section id="rfc.authors" class="avoidbreakinside"><h2><a href="#rfc.authors">Authors' Addresses</a></h2><address><b>Piers O'Hanlon</b><br>British Broadcasting Corporation<br>EMail: <a href="mailto:piers.ohanlon@bbc.co.uk">piers.ohanlon@bbc.co.uk</a></address><address><b>James Gruessing</b><br>British Broadcasting Corporation<br>EMail: <a href="mailto:james.gruessing@bbc.co.uk">james.gruessing@bbc.co.uk</a></address></section></body></html>
